# Building an Azure Honeynet & SOC (Live Traffic)
![Cloud Honeynet / SOC](https://i.imgur.com/aQw8Uwk.png)

## Introduction

In this project, I designed and deployed a honeynet within Microsoft Azure, integrating multiple log sources into a centralized Log Analytics workspace. Microsoft Sentinel was leveraged to process this data, enabling the visualization of attack vectors, the triggering of alerts, and the generation of security incidents. Over an initial 24-hour period, I collected baseline security metrics from an unsecured environment, after which I implemented targeted security controls to harden the system. A second 24-hour monitoring period followed to capture and compare the impact of these controls. Key metrics included:

- SecurityEvent (Windows Event Logs)
- Syslog (Linux Event Logs)
- SecurityAlert (Alerts Triggered by Log Analytics)
- SecurityIncident (Incidents Generated by Sentinel)
- AzureNetworkAnalytics_CL (Malicious Network Flows Detected in the Honeynet)

## Architecture Before Hardening / Security Controls
![Architecture Diagram](https://i.imgur.com/tlxJjTT.png)

## Architecture After Hardening / Security Controls
![Architecture Diagram](https://i.imgur.com/8WSkYOo.png)

The architecture of the Azure-based honeynet consisted of the following components:

- Virtual Network (VNet)
- Network Security Group (NSG)
- Virtual Machines (2 Windows, 1 Linux)
- Log Analytics Workspace
- Azure Key Vault
- Azure Storage Account
- Microsoft Sentinel

For the 'BEFORE' phase, all resources were deployed with public exposure to the internet. The Virtual Machines had their Network Security Groups (NSGs) and internal firewalls fully open, while other resources were accessible through public endpoints, without the use of Private Endpoints.

In the 'AFTER' phase, security controls were applied to harden the environment. The NSGs were configured to block all traffic except from my administrative workstation, and all other resources were secured using internal firewalls and Private Endpoints to limit exposure.

## Attack Maps Before Hardening / Security Controls
![Windows RDP/SMB Auth Failures](https://i.imgur.com/u2G7j3Y.png)<br>
![Linux Syslog Auth Failures](https://i.imgur.com/zlba7SU.png)<br>
![NSG Allowed Inbound Malicious Flows](https://i.imgur.com/MLlGf15.png)<br>

## Metrics Before Hardening / Security Controls

The table below presents the metrics collected from the unsecured environment over a 24-hour period:

- Start Time 2024-09-17 21:56:39
- Stop Time 2024-09-18 21:56:39

| Metric                   | Count
| ------------------------ | -----
| SecurityEvent            | 91449
| Syslog                   | 1216
| SecurityAlert            | 5
| SecurityIncident         | 181
| AzureNetworkAnalytics_CL | 2387

## Attack Maps Before Hardening / Security Controls

```All map queries actually returned no results due to no instances of malicious activity for the 24 hour period after hardening.```

## Metrics After Hardening / Security Controls

The table below presents the metrics collected over an additional 24-hour period after the implementation of security controls:

- Start Time: 2024-09-19 04:37:30
- Stop Time:	2024-09-20 04:37:30

| Metric                   | Count
| ------------------------ | -----
| SecurityEvent            | 17389
| Syslog                   | 0
| SecurityAlert            | 0
| SecurityIncident         | 0
| AzureNetworkAnalytics_CL | 0

## Overall Improvement
| Metric                   | Count
| ------------------------ | -----
| SecurityEvent            | -80.99%
| Syslog                   | -100.00%
| SecurityAlert            | -100.00%
| SecurityIncident         | -100.00%
| AzureNetworkAnalytics_CL | -100.00%

## Conclusion

In this project, a honeynet was successfully deployed in Microsoft Azure, with various log sources integrated into a Log Analytics workspace. Microsoft Sentinel was utilized to generate alerts and incidents based on the ingested data. Metrics were gathered both before and after the application of security controls, revealing a substantial reduction in security events and incidents, demonstrating the effectiveness of the implemented measures.

However, had the network resources been under heavier usage by regular users, it is likely that more security events and alerts would have been triggered during the 24-hour period following the implementation of these controls.
